<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Shop Ziegler</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <h1>Shop Ziegler</h1>
    <div id="controls">
      <input type="text" id="searchInput" placeholder="🔍 Suche..." />
      <button id="logoutBtn">Logout</button>
      <div id="settingsMenu">
        <button id="settingsIcon">⚙</button>
        <div id="dropdownMenu">
          <a href="#">Produkte</a>
          <a href="#">Warenkorb</a>
          <a href="#">Profil</a>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div id="filterBox">
      <label for="priceRange">Preisfilter (max €): <span id="priceLabel">1000</span></label>
      <input type="range" id="priceRange" min="0" max="1000" value="1000" />
    </div>

    <div id="productList" class="product-list"></div>
  </div>

  <div id="productModal" class="modal">
    <div class="modal-content">
      <h2 id="modalName"></h2>
      <div><img id="modalImg1"><img id="modalImg2"></div>
      <p id="modalDesc"></p>
      <p>Preis: <span id="modalPrice"></span> €</p>
      <button class="cart-btn">+ Warenkorb</button>
      <button class="buy-btn">Kaufen</button>
      <button class="close-btn" onclick="document.getElementById('productModal').classList.remove('active')">Schließen</button>
    </div>
  </div>

  <script type="module">
    import { auth } from './firebase-config.js';
    import { onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-auth.js";

    const products = [
      { name: "Smartphone", price: 299, images: ["https://via.placeholder.com/300x200?text=Vorne", "https://via.placeholder.com/300x200?text=Hinten"], description: "Tolles Handy." },
      { name: "Laptop", price: 799, images: ["https://via.placeholder.com/300x200?text=Laptop+V", "https://via.placeholder.com/300x200?text=Laptop+R"], description: "Starker Laptop." },
      { name: "Kopfhörer", price: 49, images: ["https://via.placeholder.com/300x200?text=Hub+V", "https://via.placeholder.com/300x200?text=Hub+S"], description: "Musik hören." }
    ];

    onAuthStateChanged(auth, user => {
      if (!user) window.location.href = 'index.html';
    });

    document.getElementById('logoutBtn').onclick = () => {
      signOut(auth).then(() => location.href = 'index.html');
    };

    const searchInput = document.getElementById('searchInput');
    const priceRange = document.getElementById('priceRange');
    const priceLabel = document.getElementById('priceLabel');

    function render() {
      const q = searchInput.value.toLowerCase();
      const max = parseFloat(priceRange.value);
      priceLabel.textContent = max;
      const list = document.getElementById('productList');
      list.innerHTML = "";

      products
        .filter(p => p.name.toLowerCase().includes(q) && p.price <= max)
        .forEach(p => {
          const div = document.createElement('div');
          div.className = 'product';
          div.innerHTML = `<img src="${p.images[0]}"><h3>${p.name}</h3><p>${p.price} €</p>`;
          div.onclick = () => openModal(p);
          list.appendChild(div);
        });
    }

    function openModal(p) {
      document.getElementById('modalName').textContent = p.name;
      document.getElementById('modalImg1').src = p.images[0];
      document.getElementById('modalImg2').src = p.images[1];
      document.getElementById('modalDesc').textContent = p.description;
      document.getElementById('modalPrice').textContent = p.price.toFixed(2);
      document.getElementById('productModal').classList.add('active');
    }

    searchInput.oninput = render;
    priceRange.oninput = render;

    render();
  </script>
</body>
</html>
